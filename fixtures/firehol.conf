# Firehol configuration
version 5

CTIME="82.190.13.128/29"
LAN="10.0.0.0/8 172.16.0.0/16 192.168.0.0/16"

transparent_proxy 80 8080 "root proxy" inface eth1 src "$LAN"

FIREHOL_LOG_LEVEL=7

interface eth0 ethernet
        UNMATCHED_INPUT_POLICY=DROP
        UNMATCHED_OUTPUT_POLICY=DROP
        UNMATCHED_FORWARD_POLICY=DROP
        FIREHOL_LOG_FREQUENCY="1/second"
        FIREHOL_LOG_BURST="1"
        policy drop
        protection strong 5/sec 5
        server ident reject with tcp-reset
        server "icmp ssh http" accept src "$CTIME"
        client all accept

interface eth1 lan src "$LAN"
        UNMATCHED_INPUT_POLICY=DROP
        UNMATCHED_OUTPUT_POLICY=DROP
        UNMATCHED_FORWARD_POLICY=DROP
        FIREHOL_LOG_FREQUENCY="1/second"
        FIREHOL_LOG_BURST="1"
        policy drop
        protection strong 5/sec 5
        server ident reject with tcp-reset
        server "icmp ssh dhcp http" accept
        server custom dansguardian tcp/8080 default accept src "$LAN"
        server custom transparent tcp/3129 default accept src "$LAN"
        policy accept
        client all accept

router lan2inet inface eth1 outface eth0
        masquerade
        route all accept
