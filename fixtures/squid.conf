http_port 127.0.0.1:3128
http_port 127.0.0.1:3129 intercept
cache_dir aufs /var/cache/squid3 500000 256 512
access_log daemon:/var/log/squid3/access.log squid
coredump_dir /var/cache/squid3
acl windowsupdate dstdomain windowsupdate.microsoft.com
acl windowsupdate dstdomain .update.microsoft.com
acl windowsupdate dstdomain download.windowsupdate.com
acl windowsupdate dstdomain redir.metaservices.microsoft.com
acl windowsupdate dstdomain images.metaservices.microsoft.com
acl windowsupdate dstdomain c.microsoft.com
acl windowsupdate dstdomain www.download.windowsupdate.com
acl windowsupdate dstdomain wustat.windows.com
acl windowsupdate dstdomain crl.microsoft.com
acl windowsupdate dstdomain sls.microsoft.com
acl windowsupdate dstdomain productactivation.one.microsoft.com
acl windowsupdate dstdomain ntservicepack.microsoft.com
acl wuCONNECT dstdomain www.update.microsoft.com
acl wuCONNECT dstdomain sls.microsoft.com
range_offset_limit 200 MB windowsupdate
maximum_object_size 200 MB
quick_abort_min -1
refresh_pattern -i microsoft.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip) 43200 80% 432000 reload-into-ims
refresh_pattern -i windowsupdate.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip) 43200 80% 432000 reload-into-ims
refresh_pattern -i windows.com/.*\.(cab|exe|ms[i|u|f]|[ap]sf|wm[v|a]|dat|zip) 43200 80% 432000 reload-into-ims
refresh_pattern ^ftp:             1440    20%     10080
refresh_pattern ^gopher:  1440    0%      1440
refresh_pattern -i (/cgi-bin/|\?) 0       0%      0
refresh_pattern .         0       20%     4320
acl localnet src fc00::/7
acl localnet src fe80::/10
acl localnet src 10.0.0.0/8    # RFC1918 possible internal network
acl localnet src 172.16.0.0/12 # RFC1918 possible internal network
acl localnet src 192.168.0.0/16        # RFC1918 possible internal network
acl SSL_ports port 443
acl Safe_ports port 80
acl Safe_ports port 21
acl Safe_ports port 443
acl Safe_ports port 70
acl Safe_ports port 210
acl Safe_ports port 1025-65535
acl Safe_ports port 280
acl Safe_ports port 488
acl Safe_ports port 591
acl Safe_ports port 777
acl CONNECT method CONNECT
acl classes_internet src "/etc/squid3/classes_allow"
acl mac_internet arp "/etc/squid3/mac_allow"
http_access deny !Safe_ports
http_access allow CONNECT wuCONNECT localnet
http_access allow CONNECT wuCONNECT localhost
http_access allow CONNECT localhost
http_access deny CONNECT !SSL_ports
http_access allow localhost manager
http_access deny manager
http_access allow localhost
http_access allow windowsupdate localnet
http_access allow windowsupdate localhost
http_access allow classes_internet
http_access allow mac_internet
#never_direct allow localnet
#always_direct allow localnet
http_access deny all
visible_hostname firewall
shutdown_lifetime 3600
follow_x_forwarded_for allow all
forwarded_for on
pinger_enable off
