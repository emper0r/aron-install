# Firewall config

version 6
CTIME="82.190.13.128/29"
LAN="10.0.0.0/8 172.16.0.0/16 192.168.0.0/16"

ipv4 transparent_proxy 80 3128 "root proxy" inface eth1
ipv4 transparent_proxy 80 3128 "root proxy" inface eth2
ipv4 transparent_proxy 80 3128 "root proxy" inface eth3

FIREHOL_LOG_LEVEL=7
interface4 eth0 ethernet
    UNMATCHED_INPUT_POLICY=DROP
    UNMATCHED_OUTPUT_POLICY=DROP
    UNMATCHED_FORWARD_POLICY=DROP
    FIREHOL_LOG_FREQUENCY="1/second"
    FIREHOL_LOG_BURST="1"
    policy drop
    protection strong 5/sec 5
    ipv4 server ident reject with tcp-reset
    ipv4 server "icmp ssh http" accept src "${CTIME}"
    ipv4 client all accept

interface4 eth1 lan src "${LAN}"
    policy accept
    ipv4 server all accept
    ipv4 client all accept

interface4 eth2 segretaria src "${LAN}"
    policy accept
    ipv4 server all accept
    ipv4 client all accept

interface4 eth3 discovery src "${LAN}"
    policy accept
    ipv4 server all accept
    ipv4 client all accept

router4 lan-1-inet inface eth1 outface eth0
    masquerade
    route4 all accept

router4 lan-2-inet inface eth2 outface eth0
    masquerade
    route4 all accept

router4 lan-3-inet inface eth3 outface eth0
    masquerade
    route4 all accept
